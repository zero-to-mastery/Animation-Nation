/* Liquid Hourglass — tapered, realistic glass (pure CSS, no images/JS) */

:root {
  --bg: #0b1020;
  --glass-edge: #a7b6ff66;
  --glass-fill: #9fb4ff14;

  --sand: #ffd166;
  --sand-dim: #f7b94d;

  --highlight: #ffffffaa;
  --shadow: #00000080;
}

* {
  box-sizing: border-box;
}
html,
body {
  height: 100%;
  margin: 0;
  background: radial-gradient(1200px 800px at 50% 40%, #111a33, var(--bg));
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
  color: #e9eefc;
}

.stage {
  position: fixed;
  inset: 0;
  display: grid;
  place-items: center;
}

.hourglass {
  position: relative;
  width: 240px;
  height: 380px; /* a touch taller */
}

/* Soft ground shadow */
.shadow {
  position: absolute;
  left: 50%;
  bottom: -10px;
  transform: translateX(-50%);
  width: 190px;
  height: 20px;
  border-radius: 50%;
  background: radial-gradient(60% 100% at 50% 50%, #0006, transparent 70%);
  filter: blur(5px);
}

.glass {
  position: absolute;
  inset: 0;
  display: grid;
  grid-template-rows: 1fr auto 1fr; /* top bulb / neck / bottom bulb */
  align-items: stretch;
  justify-items: center;
  overflow: visible;

  /* ✅ Broadly supported tapered outline */
  clip-path: polygon(
    22% 0%,
    78% 0%,
    /* top rim */ 68% 20%,
    60% 35%,
    /* upper taper right */ 52% 50%,
    /* waist right */ 60% 65%,
    68% 80%,
    /* lower flare right */ 78% 100%,
    22% 100%,
    /* bottom rim */ 32% 80%,
    40% 65%,
    /* lower flare left */ 48% 50%,
    /* waist left */ 40% 35%,
    32% 20% /* upper taper left */
  );

  /* edge & inner glow */
  filter: drop-shadow(0 12px 32px #0009);
}
.glass::before {
  content: '';
  position: absolute;
  inset: 0;
  clip-path: inherit;
  background: linear-gradient(180deg, #9fb4ff14, transparent 65%),
    radial-gradient(80% 50% at 20% 15%, #ffffff33 0 8%, transparent 30%)
      no-repeat,
    radial-gradient(80% 50% at 80% 18%, #ffffff22 0 5%, transparent 26%)
      no-repeat;
  box-shadow: inset 0 0 0 1.5px #a7b6ff66, inset 0 0 48px #9fb4ff22,
    inset 0 0 12px #ffffff11;
  pointer-events: none;
}

/* Top/bottom regions (no rounded bulbs anymore; clipping does the shape) */
.bulb {
  position: relative;
  width: 100%;
  height: 100%;
  overflow: hidden;
}
.top {
  align-self: end;
}
.bottom {
  align-self: start;
}

/* Narrow waist */
.neck {
  position: relative;
  width: 14px; /* thinner neck */
  height: 16px;
  margin: 2px 0;
  border-radius: 10px;
  background: linear-gradient(180deg, #a7b6ff22, #a7b6ff0c);
  box-shadow: inset 0 0 6px #9fb4ff33, 0 0 4px #9fb4ff22;
}

/* Top sand mass: drains down; curved highlight on the surface */
.top .sand {
  position: absolute;
  left: 10%;
  right: 10%;
  bottom: 8%;
  height: 52%;
  background: radial-gradient(
        100% 100% at 50% 18%,
        #ffffff55 0 6%,
        transparent 18%
      )
      no-repeat,
    linear-gradient(180deg, var(--sand), var(--sand-dim) 85%);
  box-shadow: inset 0 6px 12px #ffffff33, 0 0 20px #ffd16633;
  /* soften top/bottom edges so it sits inside the glass taper */
  -webkit-mask: radial-gradient(
    90% 70% at 50% 50%,
    #000 0 70%,
    transparent 80%
  );
  mask: radial-gradient(90% 70% at 50% 50%, #000 0 70%, transparent 80%);
  border-radius: 28% 28% 14% 14% / 35% 35% 20% 20%;
  animation: drain 8s ease-in-out infinite;
}

/* Bottom sand mass: fills up and supports a growing mound */
.bottom .sand {
  position: absolute;
  left: 10%;
  right: 10%;
  top: 10%;
  height: 14%;
  background: radial-gradient(
        100% 100% at 50% 82%,
        #ffffff44 0 6%,
        transparent 18%
      )
      no-repeat,
    linear-gradient(180deg, var(--sand), var(--sand-dim) 90%);
  box-shadow: inset 0 -6px 12px #ffffff22, 0 0 18px #ffd16622;
  -webkit-mask: radial-gradient(
    90% 70% at 50% 50%,
    #000 0 70%,
    transparent 80%
  );
  mask: radial-gradient(90% 70% at 50% 50%, #000 0 70%, transparent 80%);
  border-radius: 18% 18% 30% 30% / 22% 22% 38% 38%;
  animation: fill 8s ease-in-out infinite;
}

/* make sure the stream sits UNDER the sand masses */
.bulb {
  position: relative;
  z-index: 2;
} /* top & bottom sand above */
.neck {
  position: relative;
  z-index: 1;
} /* stream is inside the neck */

.pile {
  display: none;
}

/* Animations -------------------------------------------------------------- */
@keyframes drain {
  0% {
    height: 52%;
  }
  40% {
    height: 22%;
  }
  50% {
    height: 18%;
  }
  100% {
    height: 52%;
  } /* seamless loop */
}
@keyframes fill {
  0% {
    height: 14%;
  }
  40% {
    height: 38%;
  }
  50% {
    height: 44%;
  }
  100% {
    height: 14%;
  }
}
@keyframes mound {
  0% {
    border-top-width: 0px;
  }
  40% {
    border-top-width: 46px;
  }
  50% {
    border-top-width: 54px;
  }
  100% {
    border-top-width: 0px;
  }
}
@keyframes fall {
  0% {
    opacity: 0;
    transform: translate(-50%, -6px) scaleY(0.2);
  }
  12% {
    opacity: 1;
    transform: translate(-50%, 0) scaleY(1);
  }
  44% {
    opacity: 1;
  }
  56% {
    opacity: 0.85;
  }
  100% {
    opacity: 0;
    transform: translate(-50%, 6px) scaleY(0.25);
  }
}

/* Respect reduced motion settings */
@media (prefers-reduced-motion: reduce) {
  .top .sand,
  .bottom .sand,
  .pile {
    animation: none !important;
  }
}
